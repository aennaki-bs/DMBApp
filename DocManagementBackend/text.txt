Move Document to Next Step API
This API endpoint allows authorized users to move a document from its current step to the next step in a workflow circuit.
Endpoint
POST /api/workflow/move-next
Authorization
Requires an authenticated user with either the "Admin" or "FullUser" role.
Request Body
json{
  "documentId": 123,
  "currentStepId": 5,
  "nextStepId": 6,
  "comments": "Moving to the approval stage"
}
FieldTypeDescriptiondocumentIdintegerThe ID of the document to movecurrentStepIdintegerThe ID of the current step (for validation)nextStepIdintegerThe ID of the target step to move tocommentsstringComments about the step transition (will be stored in history)
Response
Success Response (200 OK)
json"Document moved to next step successfully."
Error Responses

400 Bad Request: Returned when validation fails

Document not found
Current step ID doesn't match
Required statuses not complete
Next step not in same circuit
Circuit already completed


401 Unauthorized: Returned when the user lacks permissions
404 Not Found: Returned when the document, current step, or next step can't be found
500 Internal Server Error: Returned on server exceptions

Workflow Logic

Validates the document exists and that it's assigned to a circuit
Checks that the specified current step matches the document's actual current step
Verifies the next step exists and belongs to the same circuit
Checks that the user has the appropriate role permissions
Ensures all required statuses are completed for the current step
Updates the document's current step
Sets the document as completed if the next step is a final step
Creates a history record of the transition
Creates document status records for the new step

Example Usage
httpPOST /api/workflow/move-next HTTP/1.1
Host: example.com
Authorization: Bearer your-token-here
Content-Type: application/json

{
  "documentId": 123,
  "currentStepId": 5,
  "nextStepId": 6,
  "comments": "Document is ready for final review"
}